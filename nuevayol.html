<!-- --------------------------------------------- GENERAL RULES ---------------------------------------------- -->
<!DOCTYPE html> <!-- Tells browser this is HTML5 doc -->
<html lang="en"> <!-- Start of HTML, sets main language to English -->
<head> <!-- Begins page title, fonts, styles, metadata section rules (non-visible content) --> 
  <meta charset="UTF-8" /> <!-- Special characters (accents) displayed properly -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <!-- Page fits mobile screens correctly -->
  <title>NUEVAYoL - Lyriciclo</title> <!-- Name shown in browser tab -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <!-- Poppins font (main font) -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Roboto font (font for symbols, i.e. '?') -->
  <style> /* Start of CSS (rules for page) */
    html, body { /* Targets <html> and <body> elements, styles inside apply to entire page */
      margin: 0; /* Removes space outside page edges (margin = space outside a box) */
      padding: 0; //* Removes space inside page edges, content starts right at edge */
      scroll-behavior: smooth; /* Scrolling glides smoothly, no jumping */
      width: 100%; /* Page fills full width of screen */
      height: 100%; /* Page fills full height of screen */
      overflow-x: hidden; /* Prevents horizontal scrolling if content is too wide */
    }
    body { /* Styles visible part of page */
      font-family: 'Poppins', sans-serif; /* Main font Poppins */
      background-color: #fff; /* Background of page is white */
      color: #333; /* Default text dark gray (less harsh than black) */
      display: flex; /* Makes layout system "flexbox"; items easily organized in rows/columns (idrk what this means) */
      flex-direction: column; /* Conent stacked vertically */
      align-items: center; /* Content centered horizontally */
    }
/* ----------------------------------------------- MENU BAR ----------------------------------------------- */
    .nav-logo { /* Styles ">Lyriciclo" (top left corner) */
      position: absolute; /* Removes logo from normal flow (for precise placing) */
      left: 0rem; /* Moves logo # of rem units from left edge of its container */
      font-weight: 600; /* Text semi-bold */
      font-size: 1.75rem; /* Sets size of text */
      text-decoration: none; /* Removes underline */
      letter-spacing: 0.3px; /* Space between each logo letter */
    }
    .top-nav { /* Styles for top navigation bar */
      width: 100%; /* Goes across whole screen */
      background: #fff; /* Has white background */
      padding: 1.6rem 0rem; /* 1.6: space above/below nav bar, 0: space on either side of nav bar */
      margin-top: 0; /* Space between bar and top of page */
      position: relative; /* Content inside nav bar can be positioned precisely */
      z-index: 1000; /* nav bar always in front of other page elements */
    }
    .top-nav .nav-inner { /* Container inside nav bar that groups logo (>Lyriciclo) and menu items together */
      display: flex; /* Horizontal layout */
      justify-content: center; /* Center everything horizontally */
      align-items: center; /* Align items vertically */
      position: relative; /* Needed for absolute positioning inside */
      max-width: 1200px; /* Keeps nav from getting too wide on big screens */
      margin: 0 auto; /* Centers nav content horizontally on page */
      width: 100%; /* Fill available width (unless greater than 1200px) */
    }
    .nav-links { /* Holds all menu items */
      display: flex; /* Menu items in row (side by side) */
      gap: 3rem; /* Space between each link */
      font-size: 1rem; /* Link text size (default) */
    }
    .nav-item { /* Each menu item in nav bar has its own dropdown menu */
      position: relative; /* Drop down in correct place (relative to menu items) */
    }
    .nav-item > a { /* Clickable text and arrow (^) inside each menu item */
      text-decoration: none; /* Removes underline from links */
      color: #4D4787; /* Color of menu text and arrow */
      font-weight: 400; /* Menu text boldness */
      padding: 0.3rem 0; /* Space above and below the menu text */
      display: inline-flex; /* Places menu text and arrow side by side */
      align-items: center; /* Vertically aligns menu text and arrow */
      gap: 1rem; /* Space between text and arrow */
      transition: color 0.2s; /* Enables smooth color change when hovering over menu items */
      font-size: 0.96rem; /* Size of menu text */
    }
    .arrow { /* Styles for arrow symbol (^) next to menu items */
      font-family: Verdana, sans-serif; /* Arrow uses Verdana font, generic sans-serif as backup */
      font-size: 0.92rem; /* Arrow text size */
      font-weight: 550; /* Arrow boldness */
      display: inline-block; /* Arrow behaves like text but allows size/transform styling */
      transform: rotate(180deg) scale(1.15, 0.9) translateY(-3px);
        /* Arrow points down, slightly stretched (wider/shorter), slightly higher */
      transition: transform 0.2s ease; /* Allows arrow to smoothly rotate */
    }
    .nav-item:hover .arrow { /* Arrow style on hover */
      transform: rotate(0deg) scale(1.15, 0.9) translateY(-3px);
        /* Flip arrow righside up , slightly stretched (wider/shorter), slightly higher */
    }
    .nav-item > a:hover { /* How main menu items behave when mouse is over them */
      color: #6150CE; /* Color of of main menu items on hover */
    }
/* -------------------------------------------- DROPDOWNS --------------------------------------------- */
    .dropdown { /* Styles for dropdown menu */
      position: absolute; /* Removes dropdown from normal flow, positioned relative to nearest element */
      top: 100%; /* Places dropdown below main menu item */
      left: 50%; /* Dropdown begins horizontally at the center of main menu item */
      transform: translateX(-50%); /* Shifts dropdown so it appears center */
      background-color: #f9f7ff; /* Dropdown background */
      padding: 0.5rem 0; /* Adds space inside dropdown (top and bottom) */
      border-radius: 0.5rem; /* Rounds corners of dropdown */
      box-shadow: 0 2px 8px rgba(0,0,0,0.08); /* Shadow below dropdown */
      display: none; /* Hides dropdown by default (only shows on hover) */
      min-width: 160px; /* Dropdown width */
      z-index: 10; /* Dropdown in front of other page elements */
    }
    .dropdown a { /* Styles for clickable links inside dropdown menu */
      display: block; /* Each link fills full width of dropdown (clickable area extends across) */
      text-align: left; /* Aligns text to left edge of dropdown */
      padding: 0.4rem 1rem; /* Adds space around text (0.4 above/below, 1 left/right) */
      text-decoration: none; /* Removes underline from links */
      font-size: 0.9rem; /* Sets size of text */
      color: #4D4787; /* Sets color of text */
      transition: background-color 0.2s; /* Smoothly fades background color on hover */
    }
    .dropdown a:hover { /* Styles apply when hover over a dropdown link */
      background-color: #eae5fa; /* Changes background color on hover */
    }
    .nav-item:hover .dropdown { /* Shows menu item's dropdown menu on hover */
      display: block; /* Hidden dropdown becomes visible on hover */
    }
/* ------------------------------------------ SONG INFO ------------------------------------------ */ 
    .song-info { /* Styles of section containing song details (title, artist, etc.) */
      width: 100%; /* Container fills same width as parent */
      max-width: 500px; /* Container will never be wider than 600px */
      text-align: center; /* Centers text inside this container */
      line-height: 1.4; /* Space between lines of text */
      margin-top: 1.3rem; /* Space above its container */
    }
    .tags { /* General container style for info badges */
      margin: 0.7rem auto 0.3rem; /* Space above (0.7rem), below (0.3rem), and center horizontally */
      display: flex; /* Arrange info badges in a row */
      justify-content: center; /* Info badges horizontally within container */
      gap: 1rem; /* Space between each info badge */
      flex-wrap: wrap; /* Allow info badges to wrap to next line if they don't fit */
    }
    .tag { /* Styles for info badges (genre, country, year) */
      background-color: #f1effc; /* Fill color */
      color: #7B6ED6; /* Text color */
      font-size: 0.8rem; /* Text size */
      padding: 0.25rem 0.8rem; /* Space inside badge (top/bottom 0.25, left/right 0.8) */
      border: none; /* No outline or border */
      border-radius: 999px; /* Rounded corners */
      font-weight: 500; /* Font boldness */
      cursor: pointer;/* Shows hand icon on hover (shows clickability) */
      transition: all 0.2s ease; /* Smooth hover animation */
    }
    .tag:hover { /* Behavior when mouse hovers over tag */
      background-color: #e3e0f5; /* Background becomes slightly darker on hover */
    }
/* ----------------------- SONG TITLE ----------------------- */
    h1 { /* Styles for song title */
      color: #4D4787; /* Title text color */
      margin: 0.2rem 0 0.2rem; /* Space above and below title */
    }
/* -------------------------------------- PLAY/PAUSE BUTTON -------------------------------------- */
    .controls { /* Container for buttons (eg playback controls and toggles) */
      display: flex; /* Buttons arranged in row */
      justify-content: center; /* Buttons centered horizontally */
      margin-top: 0.8rem;/* Space above controls */
    }
    .controls button { /* Play/pause button and icon */
      background-color: #7B6ED6; /* Button fill color */
      color: white; /* Play/pause icon color */
      border: none; /* No automatic boarder */
      font-weight: 700; /* Icon boleness */
      font-size: 1.8rem; /* Icon size */
      border-radius: 50%; /* Makes button circular */
      width: 3.5rem; /* Button width */
      height: 3.5rem; /* Button height */
      cursor: pointer; /* Pointer becomes hand on hover */
      line-height: 1; /* Line spacing */
      transition: background-color 0.2s; /* Hover transition */
      display: flex; /* Flex latout (idk ehat this means) */
      align-items: center; /* Icon centered in button veryically */
      justify-content: center; /* Icon centered in button horizontally */
      padding-bottom: 1px; /* Moves icon slightly up */
    }
    .controls button.play span { /* Play icon */
      transform: translate(3px, 2px); /* Play icon moved right and down (seems centered in button) */
    }
    .controls button.pause span { /* Pause icon */
      transform: none; /* Idk if I need this oh well */
    }
    .controls button:hover { /* Button behavior on hover */
      background-color: #9A90E2; /* Button background slightly lighter on hover */
    }
/* ----------------------------------- GENERAL LYRICS BEHAVIOR ----------------------------------- */
    .lyrics-container { /* Box that holds lyrics (scrollable area) */
      width: 100%; /* Goes across full screen width */
      max-width: 600px; /* Max width if scree is 600+px */
      height: 70vh; /* Goes across 70% of screen vertically */
      overflow-y: auto; /* Scroll when lyrics take up more than 70% */
      scroll-behavior: smooth; /* Smooth jump to lyric lines */
      padding-bottom: 4rem; /* Space between last lyric line and edge of box */
      scroll-padding-top: 3rem; /* When scrolling to a line, line has a bit of space */
      scroll-padding-bottom: 5rem; /* When scrolling to a line near bottom, some space below it */
      scrollbar-width: none; /* Hide scrollbar in Firefox */
    }
    .lyrics-container::-webkit-scrollbar { /* Targets scrollbar styling in majority of browsers */
      display: none; /* Hide scrollbar */
    }
    .lyric-line { /* Styles for each individual lyric line (separates from others) */
      margin: 1.5rem 0; /* Space above/below each line */
      text-align: center; /* Text centered horizontally */
      line-height: 1.8; /* Vertical space inside line (breathing room if line wraps) */
      font-size: 1.2rem; /* Size of lyric text */
      font-weight: 400; /* Thickness of lyric text */
      color: #9E9EBD; /* Color of default lyric text */
      transition: color 0.2s, font-weight 0.2s; /* Smoothly changes text color/weight when active */
      cursor: pointer; /* Shows hand cursor on hover (like a clickable element) */
      scroll-margin-top: 0; /* No scroll space above line when clicked on */
    }
    .lyric-line:hover { /* When user hovers over a lyric line */
      font-weight: 600; /* Make the text bolder */
    }
    .lyric-line.active { /* Style for currently highlighted (synced) lyric line */
      font-weight: 600; /* Make the text bolder */
      color: #6150CE; /* Change color to bright purple */
    }
    .lyric-line .spanish { display: block; } /* Spanish line is on its own line */
    .lyric-line .english { display: block; } /* English line is on its own line */

    .lyric-line .english.dual-mode { /* Style of inactive english line in dual mode */
      color: #bbb; /* Color of inactive english text in dual mode */
      font-weight: 300; /* Boldness of inactive english text in dual mode */
    }
    .lyric-line.active .english.dual-mode { /* Style of active english line in dual mode */
      color: #8F85C4; /* Color of active english text in dual mode */
      font-weight: 400; /* Boldness of active english text in dual mode */
    }
/* ----------------------- BACK TO TOP TEXT ----------------------- */    
    .back-to-top a { /* Style of back to top text */
      color: #4D4787; /* Color of back to top text */
      text-decoration: none; /* Removes automatic underline */
      transition: color 0.2s ease; /* Smooth color change on hover */
    }
    .back-to-top a:hover { /* Style of back to top text on hover */
      color: #6150CE; /* Color of back to top text on hover */
    }
/* ----------------------------------------- MODE SELECT ----------------------------------------- */
  #mode-dropdown a.active { /* Style of mode options when it is active */
    font-weight: 600; /* Boldness of mode options when active */
    color: #6150CE; /* Color of mode text when active */
  }
.mode-selector .arrow { /* Arrow for mode select style */
  font-size: 0.78rem; /* Arrow size */
  font-weight: 600; /* Arrow boldness */
  transform: scale(1.2, 0.9); /* Arrow size */
  display: inline-block; /* Tansform and spacing works properly */
  transition: transform 0.2s ease; /* Smooth animation on rotate */
  user-select: none; /* Prevent text selection on accidental clicks */
}
.mode-selector .arrow { /* Behavior of arrow for mode select default */
  transform: rotate(180deg) scale(1.2, 0.9); /* Arrow points down by default */
}
  /* Make mode dropdown appear on hover, not click */
.mode-selector {
  position: relative;
  display: inline-block;
}
#mode-dropdown {
  display: none;
  position: absolute;
  left: 0;
  top: 100%;
  background-color: #f9f7ff;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  min-width: 120px;
  border-radius: 0.5rem;
  padding: 0.5rem 0;
  z-index: 100;
}
    #mode-dropdown.dropdown {
  min-width: 120px;
  left: 0;
  transform: none;
}
.mode-selector:hover #mode-dropdown {
  display: block !important;
}
/* Make mode button look like nav menu links */
#mode-button.nav-item-link {
  text-decoration: none;
  color: #4D4787;
  font-weight: 400;
  padding: 0.3rem 0;
  display: inline-flex;
  align-items: center;
  gap: 1rem;
  font-size: 0.96rem;
  cursor: pointer;
  user-select: none;
}
/* Hover effect like menu links */
#mode-button.nav-item-link:hover {
  color: #6150CE;
}
  </style>
</head>
<!-- ------------------------------------------------------- MENU BAR -------------------------------------------------------- -->
<body> <!-- Start of page body -->
  <nav class="top-nav">  <!-- Meny bar container -->
    <div class="nav-inner"> <!-- Inner wrapper for navigation content to control width/alignment -->
      <a href="#" class="nav-logo"> <!-- Clickable logo link to take user to homepage -->
        <span style="color: #b2b6f6;">></span><span style="color: #7B6ED6;">Lyric</span><span style="color: #b2b6f6;">iclo</span>
          <!-- Colors of '>Lyriciclo' in up left logo -->
      </a> <!-- End of logo styles -->
      <div class="nav-links"> <!-- Container for all main menu bar links -->
        <div class="nav-item">  <!-- Songs nav item container -->
          <a href="#">Songs <span class="arrow">^</span></a> <!-- Nav link labeled 'Songs' with arrow to show dropdown -->
          <div class="dropdown"> <!-- Dropdown menu container for 'Songs', shown on hover or click -->
            <a href="#">By Popularity</a> <!-- Link to take users to all songs sorted by popularity -->
            <a href="#">By Genre</a> <!-- Link to take users to all songs sorted by genra -->
            <a href="#">By Country</a> <!-- Link to take users to all songs sorted by counry -->
            <a href="#">Coming soon</a> <!-- Link to song I am currently coding -->
          </div> <!-- End of dropdowns in 'Songs' -->
        </div> <!-- End of 'Songs' -->
        <div class="nav-item"> <!-- 'About' nav item container -->
          <a href="#">About <span class="arrow">^</span></a> <!-- Nav link labeled 'About' with arrow to show dropdown -->
          <div class="dropdown"> <!-- Dropdown menu container for 'About', shown on hover or click -->
            <a href="#">Behind Lyriciclo</a> <!-- Link to 'Behind Lyriciclo' page -->
            <a href="#">My Process</a> <!-- Link to 'My Process' page -->
          </div> <!-- End of dropdowns in 'About' -->
        </div> <!-- End of 'About' -->
        <div class="nav-item"> <!-- 'Contact' nav item container -->
          <a href="#">Contact <span class="arrow">^</span></a> <!-- Nav link labeled 'Contact' with arrow to show dropdown -->
          <div class="dropdown"> <!-- Dropdown menu container for 'Contact', shown on hover or click -->
            <a href="https://forms.gle/i7RRrc4sTaDEL3PNA" target="_blank" rel="noopener noreferrer">Suggest a Song</a>
              <!-- Link to form for song suggestions, opens in new tab -->
            <a href="#">Report a Problem</a> <!-- Link to form for reporting problems, opens in new tab -->
          </div> <!-- End of dropdowns in 'Contact' -->
        </div> <!-- End of 'Contact' -->
      </div> <!-- Closing nav-links container -->
    </div> <!-- Closing nav-inner container -->
  </nav> <!-- Closing menu bar -->
<!-- ------------------------------------------------ SONG INFO ------------------------------------------------- -->  
<div class="song-info"> <!-- Container for song-related info (genre, region, etc.) -->
  <div class="tags"> <!-- Container  for displaying song tags -->
    <span class="tag">Dembow</span> <!-- Individual tag label displaying genre -->
    <span class="tag">Reguetón</span>  <!-- Tag for additional genre -->
    <span class="tag">Puerto Rico</span> <!-- Tag for country of origin -->
  </div> <!-- Close tags container -->
</div> <!-- Close song-info container -->
  <h1>NUEVAYoL</h1> <!-- Title of the song page, styled as a large heading -->
<div style="text-align: center;"> <!-- Center-aligns all inner content horizontally -->
  <div style="display: inline-flex; align-items: center; justify-content: center; gap: 0.4rem;">
    <!-- Horizontally and vertically centered, vetical space above/below -->
    <div style="color: #7B6ED6; font-weight: 500;">DeBÍ TiRAR MáS FOToS</div> <!-- Song title, color, and boldness -->
  </div> <!-- Close inline-flex title container -->
  <div style="color: #4D4787; font-size: 0.85rem; margin-top: 0.3rem;">Bad Bunny | 2025</div>
    <!-- Artist name and year, styled in a smaller, darker font with spacing from title -->
</div> <!-- Close text-align center container -->
<!-- ------------------------------ PLAYBACK BUTTON -------------------------------- -->
  <div class="controls"> <!-- Start of playback controls container -->
    <button id="play-pause" class="play"><span>▶︎</span></button>
      <!-- Play/pause button, 'play' by default; ID for Java; shows play symbol (▶︎) -->
  </div> <!-- End of playback controls container -->
<!-- -------------------------------------------------------------- MODE SELECTOR --------------------------------------------------------------- -->
 <div class="mode-selector nav-item" style="position: relative; display: inline-block;">
     <!-- Container for the mode toggle; positioned relative so inside dropdown is placed correctly; 'inline-block' keeps inline with other items -->
<a href="#" id="mode-button" class="nav-item-link">
  Bilingual <span class="arrow">^</span>
</a>
  <div id="mode-dropdown" class="dropdown">
    <!-- Dropdown menu container for lyric modes; positioned directly below the button; min width matches button -->
    <a href="#" data-mode="spanish">Spanish</a>
      <!-- Option to switch to Spanish-only lyrics; 'data-mode' used by Java to identify selected mode -->
    <a href="#" data-mode="dual" class="active">Bilingual</a>
      <!-- Option to switch to Dual view; default; 'data-mode' used by Java to identify selected mode -->
    <a href="#" data-mode="english">English</a>
      <!-- Option to switch to English-only lyrics; 'data-mode' used by Java to identify selected mode -->
  </div> <!-- End of dropdown menu -->
</div> <!-- End of full mode-selector block -->
<!-- ------------------------------- LYRICS TEXT --------------------------------- -->
<div class="lyrics-container" id="lyrics"> <!-- Main container for all lyric lines -->
  <div class="lyric-line" data-time="0"> <!-- Timestamp (in seconds) -->
    <div class="spanish">¡Nueva Yol!</div> <!-- Original lyrics in Spanish -->
    <div class="english">New York!</div> <!-- English translation -->
  </div>
  <div class="lyric-line" data-time="3">
    <div class="spanish">Si te quieres divertir</div>
    <div class="english">If you want to have fun</div>
  </div>
  <div class="lyric-line" data-time="6">
    <div class="spanish">Con encanto y con primor</div>
    <div class="english">With style and with flair</div>
  </div>
  <div class="lyric-line" data-time="9">
    <div class="spanish">Solo tienes que vivir (¿Pa' dónde?)</div>
    <div class="english">You just have to live (Where to?)</div>
  </div>
  <div class="lyric-line" data-time="12">
    <div class="spanish">Un verano en Nueva York (¡Nueva York!)</div>
    <div class="english">A summer in New York (New York!)</div>
  </div>
  <div class="lyric-line" data-time="15">
    <div class="spanish">Si te quieres divertir</div>
    <div class="english">If you want to have fun</div>
  </div>
  <div class="lyric-line" data-time="18">
    <div class="spanish">Con encanto y con primor (¿Pero qué es esto?)</div>
    <div class="english">With style and with flair (What’s this about?)</div>
  </div>
  <div class="lyric-line" data-time="21">
    <div class="spanish">Solo tienes que vivir (¿Y este frío?)</div>
    <div class="english">You just have to live (And this cold?)</div>
  </div>
  <div class="lyric-line" data-time="24">
    <div class="spanish">Un verano en Nueva York (Un ratito na' má')</div>
    <div class="english">A summer in New York (Just for a bit, that’s it)</div>
  </div>
<!-- ----------------------------------- BACK TO TOP BUTTON ------------------------------------ -->  
  <div class="back-to-top" style="text-align: center; margin-top: 2rem; font-size: 0.9rem;">
    <!-- Center the link horizontally; space between link and last lyric; font size -->
    <a id="back-to-top-link" href="#">Back to Top</a> <!-- Clicking scrolls to first lyrics line -->
  </div> <!-- End of back-to-top container -->
  </div> <!-- End of lyrics container -->
</div> <!-- End of outer wrapper, closes full content block) -->
<!-- ---------------------------------------------- PLAYBACK SETUP ----------------------------------------------- -->
<script>
  // Get references to key elements
  const lines = document.querySelectorAll('.lyric-line'); // All lyric lines
  const playPauseBtn = document.getElementById('play-pause'); // Play/pause button
  const playPauseIcon = playPauseBtn?.querySelector('span'); // Icon inside play/pause button
  const backToTopLink = document.getElementById('back-to-top-link'); // "Back to Top" link
  // Initialize playback state
  let isPlaying = false, // Whether playback is active
      current = 0,       // Current lyric line index
      startTime = null,  // Timestamp when playback started
      intervalId = null, // ID for setInterval
      pausedAt = 0,      // How many seconds into the song we're paused
      finished = false;  // Whether the song has finished
  // Reset playback to the top of the lyrics
  function resetToTopState() {
    lines.forEach(l => l.classList.remove('active')); // Remove all active highlights
    current = 0;
    pausedAt = 0;
    finished = false;
    lines[0]?.scrollIntoView({ behavior: 'smooth', block: 'start' }); // Scroll to first line
  }
  // When the page loads
  window.onload = () => {
    resetToTopState(); // Start at the top
    setMode('dual');   // Default to dual mode (both languages)
  };
  // Click handler for "Back to Top" link
  backToTopLink?.addEventListener('click', (e) => {
    e.preventDefault();
    resetToTopState();
  });
  // Scroll the specified lyric line into view
  function scrollLine(line) {
    line.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }
  // Main playback loop, called on interval
function smartScrollTo(line) {
  const container = document.getElementById('lyrics');
  const mode = currentMode;
  // Amount of space above the line depending on mode
  const offset = mode === 'dual' ? 100 : 40;
  const containerTop = container.getBoundingClientRect().top;
  const lineTop = line.getBoundingClientRect().top;
  const scrollAmount = lineTop - containerTop - offset;
  container.scrollBy({ top: scrollAmount, behavior: 'smooth' });
}
  function updatePlayback() {
    const now = (Date.now() - startTime) / 1000; // Time since playback began, in seconds
    // If we've reached the end
    if (current >= lines.length) {
      clearInterval(intervalId); // Stop playback
      isPlaying = false;
      finished = true;
      playPauseIcon.textContent = '▶︎'; // Update icon to play
      playPauseBtn.classList.remove('pause');
      playPauseBtn.classList.add('play');
      setTimeout(() => lines.forEach(l => l.classList.remove('active')), 1500); // Clear highlight after delay
      return;
    }
    // Get the current line and its timestamp
    const line = lines[current];
    const time = parseFloat(line.dataset.time);
    // If the current time has passed the line's timestamp
    if (now >= time) {
      lines.forEach(l => l.classList.remove('active')); // Clear highlights
      line.classList.add('active'); // Highlight current line
      // Scroll to previous line if not at beginning or end
      if (current > 0 && current < lines.length - 1) {
        lines[current - 1].scrollIntoView({ behavior: 'smooth', block: 'start' });
      } else {
        line.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
      current++; // Move to next line
    }
  }
  // Play/pause button behavior
  playPauseBtn?.addEventListener('click', () => {
    if (finished) resetToTopState(); // If finished, restart
    if (!isPlaying) {
      // Start playback
      startTime = Date.now() - pausedAt * 1000; // Adjust for paused time
      intervalId = setInterval(updatePlayback, 100); // Update every 100ms
      playPauseIcon.textContent = 'II'; // Change icon to pause
      playPauseBtn.classList.remove('play');
      playPauseBtn.classList.add('pause');
      isPlaying = true;
    } else {
      // Pause playback
      clearInterval(intervalId);
      pausedAt = (Date.now() - startTime) / 1000; // Save current time
      playPauseIcon.textContent = '▶︎'; // Change icon to play
      playPauseBtn.classList.remove('pause');
      playPauseBtn.classList.add('play');
      isPlaying = false;
    }
  });
  // Clicking on a lyric line will jump to it
lines.forEach((line, index) => {
  line.addEventListener('click', () => {
    const time = parseFloat(line.dataset.time);
    current = index;
    pausedAt = time;
    if (isPlaying) {
      clearInterval(intervalId);
      startTime = Date.now() - time * 1000;
      intervalId = setInterval(updatePlayback, 100);
    }
    lines.forEach(l => l.classList.remove('active'));
    line.classList.add('active');
    if (index > 0 && index < lines.length - 1) {
      lines[index - 1].scrollIntoView({ behavior: 'smooth', block: 'start' });
    } else {
      line.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
  });
});
  // Mode switching: English / Spanish / Dual
  const modeSelect = document.getElementById('mode-select'); // For <select> dropdown (if used)
  const spanishLines = document.querySelectorAll('.spanish'); // All Spanish lines
  const englishLines = document.querySelectorAll('.english'); // All English lines
  function setMode(mode) {
    // Show/hide Spanish
    spanishLines.forEach(span => {
      span.style.display = (mode === 'english') ? 'none' : 'block';
    });
    // Show/hide English and add class for dual styling
    englishLines.forEach(en => {
      en.style.display = (mode === 'spanish') ? 'none' : 'block';
      en.classList.toggle('dual-mode', mode === 'dual');
    });
  }
  // If using a <select> menu (optional support)
  modeSelect?.addEventListener('change', () => {
    setMode(modeSelect.value);
  });
  // Mode dropdown (button-style)
  const modeButton = document.getElementById('mode-button'); // Button to toggle dropdown
  const modeDropdown = document.getElementById('mode-dropdown'); // Dropdown menu
  const modeLinks = modeDropdown.querySelectorAll('a'); // Each mode option
  let currentMode = 'dual'; // Default mode
  // Selecting a mode from the dropdown
modeLinks.forEach(link => {
  link.addEventListener('click', (e) => {
    e.preventDefault();
    currentMode = link.dataset.mode;
    // Replace button's text content except the arrow
    // We'll set modeButton's innerHTML to: selected mode text + a space + arrow span
    modeButton.innerHTML = link.textContent + ' <span class="arrow">^</span>';
    modeDropdown.style.display = 'none';
    modeLinks.forEach(l => l.classList.remove('active'));
    link.classList.add('active');
    setMode(currentMode);
  });
});
</script>
